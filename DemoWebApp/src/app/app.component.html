<h1>Demo Web App</h1>


<div class="form-group">
  <div class="input-group" *ngFor="let f of apiValues.savedFilterSet; index as i">
    <div class="input-group-prepend">
      <span class="input-group-text"><strong>{{apiValues.filterColumns[f.columnID].displayName}}</strong></span>
    </div>
    <span class="input-group-text">{{apiValues.filterOperators[f.operatorID].name}}:</span>
    <span class="form-control">{{f.value}}</span>
    <div class="input-group-append">
      <button class="btn btn-outline-secondary" type="button" (click)="removeFilter(i)" title="Remove">&times;</button>
    </div>
  </div>
  <div class="input-group">
    <button type="button" class="btn btn-success" (click)="submitFilter()">Submit</button>
  </div>
</div>

<div class="form-group">
  <div class="input-group">
    <select class="form-control" [(ngModel)]="stagingFilter.columnID" (change)="onChangeStagingColumn()">
      <option [ngValue]="-1" selected="selected">Add condition on...</option>
      <option *ngFor="let c of listColumns; index as i" [ngValue]="c">{{apiValues.filterColumns[c].displayName}}</option>
    </select>

    <select class="form-control" (change)="onChangeStagingOperator()" *ngIf="stagingFilter.columnID!==''&&stagingFilter.columnID!==-1" [(ngModel)]="stagingFilter.operatorID">
      <option *ngFor="let op of apiValues.filterColumns[stagingFilter.columnID].supportedFilterOperators; index as i" [ngValue]="op">{{apiValues.filterOperators[op].name}}</option>
    </select>

    <input class="form-control" *ngIf="apiValues.filterOperators[stagingFilter.operatorID] != undefined && apiValues.filterOperators[stagingFilter.operatorID].isMultiValue==false && apiValues.filterColumns[stagingFilter.columnID].availableValues.length == 0" [(ngModel)]="stagingFilter.value[0]" />

    <select class="form-control" *ngIf="apiValues.filterOperators[stagingFilter.operatorID] != undefined && apiValues.filterOperators[stagingFilter.operatorID].isMultiValue==false && apiValues.filterColumns[stagingFilter.columnID].availableValues.length > 0" [(ngModel)]="stagingFilter.value[0]">
      <option *ngFor="let v of apiValues.filterColumns[stagingFilter.columnID].availableValues; index as i" [ngValue]="v.value">{{v.label}}</option>
    </select>

    <select class="form-control" *ngIf="apiValues.filterOperators[stagingFilter.operatorID] != undefined && apiValues.filterOperators[stagingFilter.operatorID].isMultiValue==true && apiValues.filterColumns[stagingFilter.columnID].availableValues.length > 0" multiple="multiple" [(ngModel)]="stagingFilter.value">
      <option *ngFor="let v of apiValues.filterColumns[stagingFilter.columnID].availableValues; index as i" [ngValue]="v.value">{{v.label}}</option>
    </select>

    <button #submitbtn type="button" class="btn btn-outline-primary" *ngIf="apiValues.filterOperators[stagingFilter.operatorID] != undefined && apiValues.filterColumns[stagingFilter.columnID] != undefined && stagingFilter.value[0] != undefined" (click)="AddFilter()">+</button>
  </div>
  <div>

  </div>
</div>
<div *ngIf="isLoading">Loading...</div>

<br />
<fieldset>
  <legend>Debug:</legend>
  <div>Operator ID: {{stagingFilter.operatorID }}</div>
  <div *ngIf="apiValues.filterOperators[stagingFilter.operatorID] != undefined">
    Is Multi value: {{ apiValues.filterOperators[stagingFilter.operatorID].isMultiValue }}<br />
    Available Values: <span *ngFor="let v of apiValues.filterColumns[stagingFilter.columnID].availableValues">{{v.value}};</span><br />
    Values: <span *ngFor="let v of stagingFilter.value">{{v}};</span><br />
  </div>
  <div>Filter Body:</div>
  <pre style="overflow:auto; white-space:pre-wrap; word-wrap:break-word; background-color: lightgray">{{printJson(apiValues.savedFilterSet)}}</pre>
  <div>Response Body:</div>
  <pre style="overflow:auto; white-space:pre-wrap; word-wrap:break-word; background-color: lightgray">{{printJson(httpResponse)}}</pre>
</fieldset>
<!--
<ul class="list-group">
  <li class="list-group-item" *ngFor='let fc of apiValues.filterColumns'>
    <div class="input-group" *ngIf='fc.supportedFilterOperators[0]!=""'>

      <select class="select2 form-control">
        <option *ngFor="let pr of apiValues.filterOperators | filterSupportedOperators:fc.supportedFilterOperators" value="pr.OperatorID">{{pr.name}}</option>
      </select>

  <input type="text" />

    </div>
  </li>
</ul>
<script>
  $(".select2").select2({
    tags: true
  })
</script>
-->
